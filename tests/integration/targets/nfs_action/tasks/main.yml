---
# NFS action integration tests are currently disabled due to dependency on NFS shares,
# which have extremely slow provisioning times (30+ minutes to hours) and frequently
# get stuck in CREATING state indefinitely. The nfs_action module code has been fixed
# with proper parameter handling, but tests cannot run reliably until the DigitalOcean
# NFS backend is more stable.
#
# See aliases file for disabled status.

- block:

    - name: Verify API token
      ansible.builtin.assert:
        that:
          - digitalocean_token is string
          - digitalocean_token | length > 0
        fail_msg: digitalocean_token should be defined in tests/integration/integration_config.yml

    - name: Setup NFS share
      ansible.builtin.include_tasks:
        file: 00_setup.yml

    - name: Test nfs_action | Resize
      ansible.builtin.include_tasks:
        file: 01_resize.yml

  always:
    - name: Teardown NFS share
      ansible.builtin.include_tasks:
        file: 99_teardown.yml
